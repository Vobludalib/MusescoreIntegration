# Automatic Musescore plugin factory for external processing
By: Simon Libricky - [simonlibricky.com](www.simonlibricky.com)

As part of Charles University Individual Software Project

## TL;DR
This Python script exists to allow integration between external MXL processing and Musescore. Given a valid JSON file in the format described below, it will produce a barebones Musescore plugin QML file, that allows calling an external process on the command line and facilitate barebones reading of the score and writing to the score from MXL files generated by the process.

## Disclaimer
The QML code this script produces has no guarantees as to code quality or extendability. The code generated corresponds to what is easiest to automatically generate, but manual refactoring may be useful before using the code further. The visual layout of the plugin is barebones, and for a serious plugin I recommend manually changing the QML to look better. However, the difficult part of compiling command line arguments and calling external processes should be taken care of.

Inspiration in how to proceed was taken from: [ABC_ImpEx](https://github.com/mist13/ABC_ImpEx)

**THE PLUGINS GENERATED ARE WRITTEN FOR MUSESCORE 3.6** - I will hopefully update to 4.x after the Musescore plugin changes go through on their end and are properly documented.

## JSON Format
Ignore the // as comments
```
{ // Everything enclosed in a singular object
    "pluginName": String // Will become the string under which the plugin is seen as in MS
    "pluginVersion": String // Becomes the version number - subject to testing if there are limitations
    "readsScore": Bool // If the plugin needs to generate code to store the score into MXL
    "writesScore": Bool // If the plugin needs to generate code to load MXL into the score
    // If either of these are true, the MS plugin will have requiresScore set to true
    "defaultSavePath": String // File to which the MS score should be stored to as MXL
    "defaultLoadPath": String // File from which to read MXL into the MS score
    "optionFields": [optionObjects] // See below
}
```

optionFields is a list of all the buttons/text fields etc. that will appear in the plugin. These are directly tied to which command line arguments are sent and their values. For more complex behaviour, you are likely to have to write some QML manually, but the format of how to apply your own changes to the framework of compiling command line arguments should be able to be gleaned from the code.

Currently supported:

- TextField - corresponds to [QML TextField](https://doc.qt.io/qt-5/qml-qtquick-controls-textfield.html)

    Format: { "type": "textField", "promptString": "xxx", "defaultValue": "xxx", "cla": "-xxx" }

- FileDialog - corresponds to [QML FileDialog](https://doc.qt.io/qt-5/qml-qtquick-dialogs-filedialog.html)

    Format: { "type": "fileDialog", "promptString": "xxx", "defaultValue": "./xxx/xxx", "cla": "-xxx" }

- ComboBox - corresponds to [QML ComboBox](https://doc.qt.io/qt-5/qml-qtquick-controls2-combobox.html)

    Format: { "type": "comboBox", "promptString": "xxx", "values": [ {"name": "DisplayName", "arg": "claName"}, {"name": "DisplayName2", "arg": "claName2"} ], "defaultValue": "xxx", "cla": "-xxx" }

    "values" here is a collection of the options to select from in the ComboBox. In the above example, this would mean a ComboBox with two options: DisplayName and DisplayName2. If we selected DisplayName2, then on the command line we would get -xxx "claName2".

- CheckBox - corresponds to [QML CheckBox](https://doc.qt.io/qt-5/qml-qtquick-controls2-checkbox.html)

    Format: Format: { "type": "checkBox", "promptString": "xxx", "defaultValue": true, "cla": "-xxx" }

    Here, if we set this CheckBox to false (i.e. it is not checked), then instead of getting -xxx "someValue" as a command line argument, we will instead just not put -xxx in the command line arguments.

## TO DO

- [ ] Document how to make custom implementations work with compiling CLargs
- [ ] Wizard to auto-generate the JSON file